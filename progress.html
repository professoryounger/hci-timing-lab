<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>HCI Timing Lab</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="assets/style.css" rel="stylesheet">

    <style>
      .bar-wrap { background:#e9ecef; border-radius:.25rem; height: 12px; overflow:hidden; }
      .bar { height:100%; width:0%; background:#0d6efd; }
      .run-btn { min-width: 110px; }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
  <div class="container-fluid">
    <a class="navbar-brand" href="index.html">HCI Timing Lab</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample" aria-controls="navbarsExample" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarsExample">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="reaction.html">Reaction Time</a></li>
        <li class="nav-item"><a class="nav-link" href="delay.html">Perceived Delay</a></li>
        <li class="nav-item"><a class="nav-link" href="progress.html">Progress Illusion</a></li>
      </ul>
      <div class="d-flex">
        <button id="downloadBtn" class="btn btn-outline-light btn-sm me-2">Download CSV</button>
        <button id="clearBtn" class="btn btn-outline-warning btn-sm">Clear Data</button>
      </div>
    </div>
  </div>
</nav>

    <main class="container">
      <h2 class="mb-3">Experiment 3: Progress Bar Illusion</h2>
      <p>Each progress bar lasts exactly 1 second but uses a different pacing.  Try them and record which <em>feels</em> fastest.</p>

      <div class="row gy-3">
        <div class="col-md-4">
          <h6>Linear</h6>
          <div class="bar-wrap mb-2"><div id="barLinear" class="bar"></div></div>
          <button class="btn btn-primary run-btn" data-kind="linear">Run</button>
        </div>
        <div class="col-md-4">
          <h6>Fast start</h6>
          <div class="bar-wrap mb-2"><div id="barFast" class="bar"></div></div>
          <button class="btn btn-primary run-btn" data-kind="fast">Run</button>
        </div>
        <div class="col-md-4">
          <h6>Slow start</h6>
          <div class="bar-wrap mb-2"><div id="barSlow" class="bar"></div></div>
          <button class="btn btn-primary run-btn" data-kind="slow">Run</button>
        </div>
      </div>

      <div class="mt-4">
        <label class="form-label">Which felt fastest?</label>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="fastest" id="fastLinear" value="Linear">
          <label class="form-check-label" for="fastLinear">Linear</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="fastest" id="fastFast" value="FastStart">
          <label class="form-check-label" for="fastFast">Fast start</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="fastest" id="fastSlow" value="SlowStart">
          <label class="form-check-label" for="fastSlow">Slow start</label>
        </div>
        <button id="recordChoice" class="btn btn-success mt-2">Record choice</button>
      </div>

      <hr>
      <div id="log"></div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="assets/script.js"></script>

    <script>
      (function() {
        const DUR = 1000;
        const bars = {
          linear: document.getElementById('barLinear'),
          fast: document.getElementById('barFast'),
          slow: document.getElementById('barSlow')
        };
        const log = document.getElementById('log');

        function animate(kind) {
          const bar = bars[kind];
          bar.style.width = '0%';
          const t0 = performance.now();
          function easeLinear(p) { return p; }
          function easeFast(p) { return Math.min(1, Math.sqrt(p)); }
          function easeSlow(p) { return Math.min(1, p*p); }
          const ease = kind === 'fast' ? easeFast : kind === 'slow' ? easeSlow : easeLinear;

          function frame(t) {
            const p = Math.min(1, (t - t0) / DUR);
            bar.style.width = (ease(p) * 100).toFixed(1) + '%';
            if (p < 1) requestAnimationFrame(frame);
          }
          requestAnimationFrame(frame);
        }

        document.querySelectorAll('.run-btn').forEach(btn => {
          btn.addEventListener('click', () => animate(btn.dataset.kind));
        });

        document.getElementById('recordChoice').addEventListener('click', () => {
          const picked = document.querySelector('input[name="fastest"]:checked');
          if (!picked) return;
          const choice = picked.value;
          const msg = 'Recorded: ' + choice;
          log.prepend(document.createTextNode(msg));
          log.prepend(document.createElement('div'));
          window.hciLog && window.hciLog({
            experiment: 'ProgressIllusion',
            trial: Date.now(),
            intendedDelayMs: 1000,
            actualDelayMs: 1000,
            reactionMs: null,
            choice: choice,
            note: ''
          });
        });

        window.hciInit && window.hciInit();
      })();
    </script>
  </body>
</html>
